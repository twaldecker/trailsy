(function(){function B(a,b,c){if(a===b)return a!==0||1/a==1/b;if(a==null||b==null)return a===b;a._chain&&(a=a._wrapped),b._chain&&(b=b._wrapped);if(a.isEqual&&x.isFunction(a.isEqual))return a.isEqual(b);if(b.isEqual&&x.isFunction(b.isEqual))return b.isEqual(a);var d=j.call(a);if(d!=j.call(b))return!1;switch(d){case"[object String]":return a==String(b);case"[object Number]":return a!=+a?b!=+b:a==0?1/a==1/b:a==+b;case"[object Date]":case"[object Boolean]":return+a==+b;case"[object RegExp]":return a.source==b.source&&a.global==b.global&&a.multiline==b.multiline&&a.ignoreCase==b.ignoreCase}if(typeof a!="object"||typeof b!="object")return!1;var e=c.length;while(e--)if(c[e]==a)return!0;c.push(a);var f=0,g=!0;if(d=="[object Array]"){f=a.length,g=f==b.length;if(g)while(f--)if(!(g=f in a==f in b&&B(a[f],b[f],c)))break}else{if("constructor"in a!="constructor"in b||a.constructor!=b.constructor)return!1;for(var h in a)if(k.call(a,h)){f++;if(!(g=k.call(b,h)&&B(a[h],b[h],c)))break}if(g){for(h in b)if(k.call(b,h)&&!(f--))break;g=!f}}return c.pop(),g}var a=this,b=a._,c={},d=Array.prototype,e=Object.prototype,f=Function.prototype,g=d.slice,h=d.concat,i=d.unshift,j=e.toString,k=e.hasOwnProperty,l=d.forEach,m=d.map,n=d.reduce,o=d.reduceRight,p=d.filter,q=d.every,r=d.some,s=d.indexOf,t=d.lastIndexOf,u=Array.isArray,v=Object.keys,w=f.bind,x=function(a){return new D(a)};typeof exports!="undefined"?(typeof module!="undefined"&&module.exports&&(exports=module.exports=x),exports._=x):typeof define=="function"&&define.amd?define("underscore",[],function(){return x}):a._=x,x.VERSION="1.2.3";var y=x.each=x.forEach=function(a,b,d){if(a==null)return;if(l&&a.forEach===l)a.forEach(b,d);else if(a.length===+a.length){for(var e=0,f=a.length;e<f;e++)if(e in a&&b.call(d,a[e],e,a)===c)return}else for(var g in a)if(k.call(a,g)&&b.call(d,a[g],g,a)===c)return};x.map=function(a,b,c){var d=[];return a==null?d:m&&a.map===m?a.map(b,c):(y(a,function(a,e,f){d[d.length]=b.call(c,a,e,f)}),d)},x.reduce=x.foldl=x.inject=function(a,b,c,d){var e=arguments.length>2;a==null&&(a=[]);if(n&&a.reduce===n)return d&&(b=x.bind(b,d)),e?a.reduce(b,c):a.reduce(b);y(a,function(a,f,g){e?c=b.call(d,c,a,f,g):(c=a,e=!0)});if(!e)throw new TypeError("Reduce of empty array with no initial value");return c},x.reduceRight=x.foldr=function(a,b,c,d){var e=arguments.length>2;a==null&&(a=[]);if(o&&a.reduceRight===o)return d&&(b=x.bind(b,d)),e?a.reduceRight(b,c):a.reduceRight(b);var f=x.toArray(a).reverse();return d&&!e&&(b=x.bind(b,d)),e?x.reduce(f,b,c,d):x.reduce(f,b)},x.find=x.detect=function(a,b,c){var d;return z(a,function(a,e,f){if(b.call(c,a,e,f))return d=a,!0}),d},x.filter=x.select=function(a,b,c){var d=[];return a==null?d:p&&a.filter===p?a.filter(b,c):(y(a,function(a,e,f){b.call(c,a,e,f)&&(d[d.length]=a)}),d)},x.reject=function(a,b,c){var d=[];return a==null?d:(y(a,function(a,e,f){b.call(c,a,e,f)||(d[d.length]=a)}),d)},x.every=x.all=function(a,b,d){var e=!0;return a==null?e:q&&a.every===q?a.every(b,d):(y(a,function(a,f,g){if(!(e=e&&b.call(d,a,f,g)))return c}),e)};var z=x.some=x.any=function(a,b,d){b||(b=x.identity);var e=!1;return a==null?e:r&&a.some===r?a.some(b,d):(y(a,function(a,f,g){if(e||(e=b.call(d,a,f,g)))return c}),!!e)};x.include=x.contains=function(a,b){var c=!1;return a==null?c:s&&a.indexOf===s?a.indexOf(b)!=-1:(c=z(a,function(a){return a===b}),c)},x.invoke=function(a,b){var c=g.call(arguments,2);return x.map(a,function(a){return(b.call?b||a:a[b]).apply(a,c)})},x.pluck=function(a,b){return x.map(a,function(a){return a[b]})},x.max=function(a,b,c){if(!b&&x.isArray(a))return Math.max.apply(Math,a);if(!b&&x.isEmpty(a))return-Infinity;var d={computed:-Infinity};return y(a,function(a,e,f){var g=b?b.call(c,a,e,f):a;g>=d.computed&&(d={value:a,computed:g})}),d.value},x.min=function(a,b,c){if(!b&&x.isArray(a))return Math.min.apply(Math,a);if(!b&&x.isEmpty(a))return Infinity;var d={computed:Infinity};return y(a,function(a,e,f){var g=b?b.call(c,a,e,f):a;g<d.computed&&(d={value:a,computed:g})}),d.value},x.shuffle=function(a){var b=[],c;return y(a,function(a,d,e){d==0?b[0]=a:(c=Math.floor(Math.random()*(d+1)),b[d]=b[c],b[c]=a)}),b},x.sortBy=function(a,b,c){return x.pluck(x.map(a,function(a,d,e){return{value:a,criteria:b.call(c,a,d,e)}}).sort(function(a,b){var c=a.criteria,d=b.criteria;return c<d?-1:c>d?1:0}),"value")},x.groupBy=function(a,b){var c={},d=x.isFunction(b)?b:function(a){return a[b]};return y(a,function(a,b){var e=d(a,b);(c[e]||(c[e]=[])).push(a)}),c},x.sortedIndex=function(a,b,c){c||(c=x.identity);var d=0,e=a.length;while(d<e){var f=d+e>>1;c(a[f])<c(b)?d=f+1:e=f}return d},x.toArray=function(a){return a?a.toArray?a.toArray():x.isArray(a)?g.call(a):x.isArguments(a)?g.call(a):x.values(a):[]},x.size=function(a){return x.toArray(a).length},x.first=x.head=function(a,b,c){return b!=null&&!c?g.call(a,0,b):a[0]},x.initial=function(a,b,c){return g.call(a,0,a.length-(b==null||c?1:b))},x.last=function(a,b,c){return b!=null&&!c?g.call(a,Math.max(a.length-b,0)):a[a.length-1]},x.rest=x.tail=function(a,b,c){return g.call(a,b==null||c?1:b)},x.compact=function(a){return x.filter(a,function(a){return!!a})},x.flatten=function(a,b){return x.reduce(a,function(a,c){return x.isArray(c)?a.concat(b?c:x.flatten(c)):(a[a.length]=c,a)},[])},x.without=function(a){return x.difference(a,g.call(arguments,1))},x.uniq=x.unique=function(a,b,c){var d=c?x.map(a,c):a,e=[];return x.reduce(d,function(c,d,f){if(0==f||(b===!0?x.last(c)!=d:!x.include(c,d)))c[c.length]=d,e[e.length]=a[f];return c},[]),e},x.union=function(){return x.uniq(x.flatten(arguments,!0))},x.intersection=x.intersect=function(a){var b=g.call(arguments,1);return x.filter(x.uniq(a),function(a){return x.every(b,function(b){return x.indexOf(b,a)>=0})})},x.difference=function(a){var b=x.flatten(g.call(arguments,1));return x.filter(a,function(a){return!x.include(b,a)})},x.zip=function(){var a=g.call(arguments),b=x.max(x.pluck(a,"length")),c=new Array(b);for(var d=0;d<b;d++)c[d]=x.pluck(a,""+d);return c},x.indexOf=function(a,b,c){if(a==null)return-1;var d,e;if(c)return d=x.sortedIndex(a,b),a[d]===b?d:-1;if(s&&a.indexOf===s)return a.indexOf(b);for(d=0,e=a.length;d<e;d++)if(d in a&&a[d]===b)return d;return-1},x.lastIndexOf=function(a,b){if(a==null)return-1;if(t&&a.lastIndexOf===t)return a.lastIndexOf(b);var c=a.length;while(c--)if(c in a&&a[c]===b)return c;return-1},x.range=function(a,b,c){arguments.length<=1&&(b=a||0,a=0),c=arguments[2]||1;var d=Math.max(Math.ceil((b-a)/c),0),e=0,f=new Array(d);while(e<d)f[e++]=a,a+=c;return f};var A=function(){};x.bind=function(a,b){var c,d;if(a.bind===w&&w)return w.apply(a,g.call(arguments,1));if(!x.isFunction(a))throw new TypeError;return d=g.call(arguments,2),c=function(){if(this instanceof c){A.prototype=a.prototype;var e=new A,f=a.apply(e,d.concat(g.call(arguments)));return Object(f)===f?f:e}return a.apply(b,d.concat(g.call(arguments)))}},x.bindAll=function(a){var b=g.call(arguments,1);return b.length==0&&(b=x.functions(a)),y(b,function(b){a[b]=x.bind(a[b],a)}),a},x.memoize=function(a,b){var c={};return b||(b=x.identity),function(){var d=b.apply(this,arguments);return k.call(c,d)?c[d]:c[d]=a.apply(this,arguments)}},x.delay=function(a,b){var c=g.call(arguments,2);return setTimeout(function(){return a.apply(a,c)},b)},x.defer=function(a){return x.delay.apply(x,[a,1].concat(g.call(arguments,1)))},x.throttle=function(a,b){var c,d,e,f,g,h=x.debounce(function(){g=f=!1},b);return function(){c=this,d=arguments;var i=function(){e=null,g&&a.apply(c,d),h()};e||(e=setTimeout(i,b)),f?g=!0:a.apply(c,d),h(),f=!0}},x.debounce=function(a,b){var c;return function(){var d=this,e=arguments,f=function(){c=null,a.apply(d,e)};clearTimeout(c),c=setTimeout(f,b)}},x.once=function(a){var b=!1,c;return function(){return b?c:(b=!0,c=a.apply(this,arguments))}},x.wrap=function(a,b){return function(){var c=h.apply([a],arguments);return b.apply(this,c)}},x.compose=function(){var a=arguments;return function(){var b=arguments;for(var c=a.length-1;c>=0;c--)b=[a[c].apply(this,b)];return b[0]}},x.after=function(a,b){return a>0?function(){if(--a<1)return b.apply(this,arguments)}:b()},x.keys=v||function(a){if(a!==Object(a))throw new TypeError("Invalid object");var b=[];for(var c in a)k.call(a,c)&&(b[b.length]=c);return b},x.values=function(a){return x.map(a,x.identity)},x.functions=x.methods=function(a){var b=[];for(var c in a)x.isFunction(a[c])&&b.push(c);return b.sort()},x.extend=function(a){return y(g.call(arguments,1),function(b){for(var c in b)b[c]!==void 0&&(a[c]=b[c])}),a},x.defaults=function(a){return y(g.call(arguments,1),function(b){for(var c in b)a[c]==null&&(a[c]=b[c])}),a},x.clone=function(a){return x.isObject(a)?x.isArray(a)?a.slice():x.extend({},a):a},x.tap=function(a,b){return b(a),a},x.isEqual=function(a,b){return B(a,b,[])},x.isEmpty=function(a){if(x.isArray(a)||x.isString(a))return a.length===0;for(var b in a)if(k.call(a,b))return!1;return!0},x.isElement=function(a){return!!a&&a.nodeType==1},x.isArray=u||function(a){return j.call(a)=="[object Array]"},x.isObject=function(a){return a===Object(a)},x.isArguments=function(a){return j.call(a)=="[object Arguments]"},x.isArguments(arguments)||(x.isArguments=function(a){return!!a&&!!k.call(a,"callee")}),x.isFunction=function(a){return j.call(a)=="[object Function]"},x.isString=function(a){return j.call(a)=="[object String]"},x.isNumber=function(a){return j.call(a)=="[object Number]"},x.isNaN=function(a){return a!==a},x.isBoolean=function(a){return a===!0||a===!1||j.call(a)=="[object Boolean]"},x.isDate=function(a){return j.call(a)=="[object Date]"},x.isRegExp=function(a){return j.call(a)=="[object RegExp]"},x.isNull=function(a){return a===null},x.isUndefined=function(a){return a===void 0},x.noConflict=function(){return a._=b,this},x.identity=function(a){return a},x.times=function(a,b,c){for(var d=0;d<a;d++)b.call(c,d)},x.escape=function(a){return(""+a).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;")},x.mixin=function(a){y(x.functions(a),function(b){F(b,x[b]=a[b])})};var C=0;x.uniqueId=function(a){var b=C++;return a?a+b:b},x.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g},x.template=function(a,b){var c=x.templateSettings,d="var __p=[],print=function(){__p.push.apply(__p,arguments);};with(obj||{}){__p.push('"+a.replace(/\\/g,"\\\\").replace(/'/g,"\\'").replace(c.escape,function(a,b){return"',_.escape("+b.replace(/\\'/g,"'")+"),'"}).replace(c.interpolate,function(a,b){return"',"+b.replace(/\\'/g,"'")+",'"}).replace(c.evaluate||null,function(a,b){return"');"+b.replace(/\\'/g,"'").replace(/[\r\n\t]/g," ")+";__p.push('"}).replace(/\r/g,"\\r").replace(/\n/g,"\\n").replace(/\t/g,"\\t")+"');}return __p.join('');",e=new Function("obj","_",d);return b?e(b,x):function(a){return e.call(this,a,x)}};var D=function(a){this._wrapped=a};x.prototype=D.prototype;var E=function(a,b){return b?x(a).chain():a},F=function(a,b){D.prototype[a]=function(){var a=g.call(arguments);return i.call(a,this._wrapped),E(b.apply(x,a),this._chain)}};x.mixin(x),y(["pop","push","reverse","shift","sort","splice","unshift"],function(a){var b=d[a];D.prototype[a]=function(){return b.apply(this._wrapped,arguments),E(this._wrapped,this._chain)}}),y(["concat","join","slice"],function(a){var b=d[a];D.prototype[a]=function(){return E(b.apply(this._wrapped,arguments),this._chain)}}),D.prototype.chain=function(){return this._chain=!0,this},D.prototype.value=function(){return this._wrapped}}).call(this),function(a,b){typeof exports!="undefined"?b(a,exports,require("underscore")):typeof define=="function"&&define.amd?define("backbone",["underscore","jquery","exports"],function(c,d,e){b(a,e,c,d)}):a.Backbone=b(a,{},a._,a.jQuery||a.Zepto||a.ender)}(this,function(a,b,c,d){var e=a.Backbone,f=Array.prototype.slice;b.VERSION="0.5.3",b.noConflict=function(){return a.Backbone=e,b},b.emulateHTTP=!1,b.emulateJSON=!1,b.Events={bind:function(a,b,c){var d=this._callbacks||(this._callbacks={}),e=d[a]||(d[a]={}),f=e.tail||(e.tail=e.next={});return f.callback=b,f.context=c,e.tail=f.next={},this},unbind:function(a,b){var c,d,e;if(!a)this._callbacks=null;else if(c=this._callbacks)if(!b)c[a]={};else if(d=c[a])while((e=d)&&(d=d.next)){if(d.callback!==b)continue;e.next=d.next,d.context=d.callback=null;break}return this},trigger:function(a){var b,c,d,e,g,h=["all",a];if(!(c=this._callbacks))return this;while(g=h.pop()){if(!(b=c[g]))continue;e=g=="all"?arguments:f.call(arguments,1);while(b=b.next)(d=b.callback)&&d.apply(b.context||this,e)}return this}},b.Model=function(a,b){var d;a||(a={});if(d=this.defaults)c.isFunction(d)&&(d=d.call(this)),a=c.extend({},d,a);this.attributes={},this._escapedAttributes={},this.cid=c.uniqueId("c"),this.set(a,{silent:!0}),this._changed=!1,this._previousAttributes=c.clone(this.attributes),b&&b.collection&&(this.collection=b.collection),this.initialize(a,b)},c.extend(b.Model.prototype,b.Events,{_changed:!1,idAttribute:"id",initialize:function(){},toJSON:function(){return c.clone(this.attributes)},get:function(a){return this.attributes[a]},escape:function(a){var b;if(b=this._escapedAttributes[a])return b;var d=this.attributes[a];return this._escapedAttributes[a]=c.escape(d==null?"":""+d)},has:function(a){return this.attributes[a]!=null},set:function(a,b){b||(b={});if(!a)return this;a.attributes&&(a=a.attributes);var d=this.attributes,e=this._escapedAttributes;if(!b.silent&&this.validate&&!this._performValidation(a,b))return!1;this.idAttribute in a&&(this.id=a[this.idAttribute]);var f=this._changing;this._changing=!0;for(var g in a){var h=a[g];c.isEqual(d[g],h)||(d[g]=h,delete e[g],this._changed=!0,b.silent||this.trigger("change:"+g,this,h,b))}return f||(!b.silent&&this._changed&&this.change(b),this._changing=!1),this},unset:function(a,b){if(a in this.attributes){b||(b={});var c=this.attributes[a],d={};return d[a]=void 0,!b.silent&&this.validate&&!this._performValidation(d,b)?!1:((this._unsetAttributes||(this._unsetAttributes=[])).push(a),delete this.attributes[a],delete this._escapedAttributes[a],a==this.idAttribute&&delete this.id,this._changed=!0,b.silent||(this.trigger("change:"+a,this,void 0,b),this.change(b)),this)}return this},clear:function(a){a||(a={});var b,c=this.attributes,d={};for(b in c)d[b]=void 0;if(!a.silent&&this.validate&&!this._performValidation(d,a))return!1;this.attributes={},this._escapedAttributes={},this._changed=!0;if(!a.silent){for(b in c)this.trigger("change:"+b,this,void 0,a);this.change(a)}return this},fetch:function(a){a||(a={});var c=this,d=a.success;return a.success=function(b,e,f){if(!c.set(c.parse(b,f),a))return!1;d&&d(c,b)},a.error=w(a.error,c,a),(this.sync||b.sync).call(this,"read",this,a)},save:function(a,c){c||(c={});if(a&&!this.set(a,c))return!1;var d=this,e=c.success;c.success=function(a,b,f){if(!d.set(d.parse(a,f),c))return!1;e&&e(d,a,f)},c.error=w(c.error,d,c);var f=this.isNew()?"create":"update";return(this.sync||b.sync).call(this,f,this,c)},destroy:function(a){a||(a={});if(this.isNew())return this.trigger("destroy",this,this.collection,a);var c=this,d=a.success;return a.success=function(b){c.trigger("destroy",c,c.collection,a),d&&d(c,b)},a.error=w(a.error,c,a),(this.sync||b.sync).call(this,"delete",this,a)},url:function(){var a=u(this.collection)||this.urlRoot||v();return this.isNew()?a:a+(a.charAt(a.length-1)=="/"?"":"/")+encodeURIComponent(this.id)},parse:function(a,b){return a},clone:function(){return new this.constructor(this)},isNew:function(){return this.id==null},change:function(a){this.trigger("change",this,a),this._previousAttributes=c.clone(this.attributes),this._unsetAttributes=null,this._changed=!1},hasChanged:function(a){return a?this._previousAttributes[a]!=this.attributes[a]:this._changed},changedAttributes:function(a){a||(a=this.attributes);var b=this._previousAttributes,d=this._unsetAttributes,e=!1;for(var f in a)c.isEqual(b[f],a[f])||(e||(e={}),e[f]=a[f]);if(d){e||(e={});var g=d.length;while(g--)e[d[g]]=void 0}return e},previous:function(a){return!a||!this._previousAttributes?null:this._previousAttributes[a]},previousAttributes:function(){return c.clone(this._previousAttributes)},_performValidation:function(a,b){var c=this.validate(a);return c?(b.error?b.error(this,c,b):this.trigger("error",this,c,b),!1):!0}}),b.Collection=function(a,b){b||(b={}),b.comparator&&(this.comparator=b.comparator),c.bindAll(this,"_onModelEvent","_removeReference"),this._reset(),a&&this.reset(a,{silent:!0}),this.initialize.apply(this,arguments)},c.extend(b.Collection.prototype,b.Events,{model:b.Model,initialize:function(){},toJSON:function(){return this.map(function(a){return a.toJSON()})},add:function(a,b){if(c.isArray(a))for(var d=0,e=a.length;d<e;d++)this._add(a[d],b);else this._add(a,b);return this},remove:function(a,b){if(c.isArray(a))for(var d=0,e=a.length;d<e;d++)this._remove(a[d],b);else this._remove(a,b);return this},get:function(a){return a==null?null:this._byId[a.id!=null?a.id:a]},getByCid:function(a){return a&&this._byCid[a.cid||a]},at:function(a){return this.models[a]},sort:function(a){a||(a={});if(!this.comparator)throw new Error("Cannot sort a set without a comparator");return this.models=this.sortBy(this.comparator),a.silent||this.trigger("reset",this,a),this},pluck:function(a){return c.map(this.models,function(b){return b.get(a)})},reset:function(a,b){return a||(a=[]),b||(b={}),this.each(this._removeReference),this._reset(),this.add(a,{silent:!0}),b.silent||this.trigger("reset",this,b),this},fetch:function(a){a||(a={});var c=this,d=a.success;return a.success=function(b,e,f){c[a.add?"add":"reset"](c.parse(b,f),a),d&&d(c,b)},a.error=w(a.error,c,a),(this.sync||b.sync).call(this,"read",this,a)},create:function(a,b){var c=this;b||(b={}),a=this._prepareModel(a,b);if(!a)return!1;var d=b.success;return b.success=function(a,e,f){c.add(a,b),d&&d(a,e,f)},a.save(null,b),a},parse:function(a,b){return a},chain:function(){return c(this.models).chain()},_reset:function(a){this.length=0,this.models=[],this._byId={},this._byCid={}},_prepareModel:function(a,c){if(a instanceof b.Model)a.collection||(a.collection=this);else{var d=a;a=new this.model(d,{collection:this}),a.validate&&!a._performValidation(a.attributes,c)&&(a=!1)}return a},_add:function(a,b){b||(b={}),a=this._prepareModel(a,b);if(!a)return!1;var c=this.getByCid(a);if(c)throw new Error(["Can't add the same model to a set twice",c.id]);this._byId[a.id]=a,this._byCid[a.cid]=a;var d=b.at!=null?b.at:this.comparator?this.sortedIndex(a,this.comparator):this.length;return this.models.splice(d,0,a),a.bind("all",this._onModelEvent),this.length++,b.index=d,b.silent||a.trigger("add",a,this,b),a},_remove:function(a,b){b||(b={}),a=this.getByCid(a)||this.get(a);if(!a)return null;delete this._byId[a.id],delete this._byCid[a.cid];var c=this.indexOf(a);return this.models.splice(c,1),this.length--,b.index=c,b.silent||a.trigger("remove",a,this,b),this._removeReference(a),a},_removeReference:function(a){this==a.collection&&delete a.collection,a.unbind("all",this._onModelEvent)},_onModelEvent:function(a,b,c,d){if(a!="add"&&a!="remove"||c==this)a=="destroy"&&this._remove(b,d),b&&a==="change:"+b.idAttribute&&(delete this._byId[b.previous(b.idAttribute)],this._byId[b.id]=b),this.trigger.apply(this,arguments);else return}});var g=["forEach","each","map","reduce","reduceRight","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","max","min","sortBy","sortedIndex","toArray","size","first","rest","last","without","indexOf","lastIndexOf","isEmpty","groupBy"];c.each(g,function(a){b.Collection.prototype[a]=function(){return c[a].apply(c,[this.models].concat(c.toArray(arguments)))}}),b.Router=function(a){a||(a={}),a.routes&&(this.routes=a.routes),this._bindRoutes(),this.initialize.apply(this,arguments)};var h=/:([\w\d]+)/g,i=/\*([\w\d]+)/g,j=/[-[\]{}()+?.,\\^$|#\s]/g;c.extend(b.Router.prototype,b.Events,{initialize:function(){},route:function(a,d,e){b.history||(b.history=new b.History),c.isRegExp(a)||(a=this._routeToRegExp(a)),b.history.route(a,c.bind(function(b){var c=this._extractParameters(a,b);e&&e.apply(this,c),this.trigger.apply(this,["route:"+d].concat(c))},this))},navigate:function(a,c){b.history.navigate(a,c)},_bindRoutes:function(){if(!this.routes)return;var a=[];for(var b in this.routes)a.unshift([b,this.routes[b]]);for(var c=0,d=a.length;c<d;c++)this.route(a[c][0],a[c][1],this[a[c][1]])},_routeToRegExp:function(a){return a=a.replace(j,"\\$&").replace(h,"([^/]*)").replace(i,"(.*?)"),new RegExp("^"+a+"$")},_extractParameters:function(a,b){return a.exec(b).slice(1)}}),b.History=function(){this.handlers=[],c.bindAll(this,"checkUrl")};var k=/^#*/,l=/msie [\w.]+/,m=!1;c.extend(b.History.prototype,{interval:50,getFragment:function(a,b){if(a==null)if(this._hasPushState||b){a=window.location.pathname;var c=window.location.search;c&&(a+=c)}else a=window.location.hash;return a=decodeURIComponent(a.replace(k,"")),a.indexOf(this.options.root)||(a=a.substr(this.options.root.length)),a},start:function(a){if(m)throw new Error("Backbone.history has already been started");this.options=c.extend({},{root:"/"},this.options,a),this._wantsPushState=!!this.options.pushState,this._hasPushState=!!(this.options.pushState&&window.history&&window.history.pushState);var b=this.getFragment(),e=document.documentMode,f=l.exec(navigator.userAgent.toLowerCase())&&(!e||e<=7);f&&(this.iframe=d('<iframe src="javascript:0" tabindex="-1" />').hide().appendTo("body")[0].contentWindow,this.navigate(b)),this._hasPushState?d(window).bind("popstate",this.checkUrl):"onhashchange"in window&&!f?d(window).bind("hashchange",this.checkUrl):setInterval(this.checkUrl,this.interval),this.fragment=b,m=!0;var g=window.location,h=g.pathname==this.options.root;if(this._wantsPushState&&!this._hasPushState&&!h)return this.fragment=this.getFragment(null,!0),window.location.replace(this.options.root+"#"+this.fragment),!0;this._wantsPushState&&this._hasPushState&&h&&g.hash&&(this.fragment=g.hash.replace(k,""),window.history.replaceState({},document.title,g.protocol+"//"+g.host+this.options.root+this.fragment));if(!this.options.silent)return this.loadUrl()},route:function(a,b){this.handlers.unshift({route:a,callback:b})},checkUrl:function(a){var b=this.getFragment();b==this.fragment&&this.iframe&&(b=this.getFragment(this.iframe.location.hash));if(b==this.fragment||b==decodeURIComponent(this.fragment))return!1;this.iframe&&this.navigate(b),this.loadUrl()||this.loadUrl(window.location.hash)},loadUrl:function(a){var b=this.fragment=this.getFragment(a),d=c.any(this.handlers,function(a){if(a.route.test(b))return a.callback(b),!0});return d},navigate:function(a,b){var c=(a||"").replace(k,"");if(this.fragment==c||this.fragment==decodeURIComponent(c))return;if(this._hasPushState){var d=window.location;c.indexOf(this.options.root)!=0&&(c=this.options.root+c),this.fragment=c,window.history.pushState({},document.title,d.protocol+"//"+d.host+c)}else window.location.hash=this.fragment=c,this.iframe&&c!=this.getFragment(this.iframe.location.hash)&&(this.iframe.document.open().close(),this.iframe.location.hash=c);b&&this.loadUrl(a)}}),b.View=function(a){this.cid=c.uniqueId("view"),this._configure(a||{}),this._ensureElement(),this.delegateEvents(),this.initialize.apply(this,arguments)};var n=function(a){return d(a,this.el)},o=/^(\S+)\s*(.*)$/,p=["model","collection","el","id","attributes","className","tagName"];c.extend(b.View.prototype,b.Events,{tagName:"div",$:n,initialize:function(){},render:function(){return this},remove:function(){return d(this.el).remove(),this},make:function(a,b,c){var e=document.createElement(a);return b&&d(e).attr(b),c&&d(e).html(c),e},delegateEvents:function(a){if(!a&&!(a=this.events))return;c.isFunction(a)&&(a=a.call(this)),this.undelegateEvents();for(var b in a){var e=this[a[b]];if(!e)throw new Error('Event "'+a[b]+'" does not exist');var f=b.match(o),g=f[1],h=f[2];e=c.bind(e,this),g+=".delegateEvents"+this.cid,h===""?d(this.el).bind(g,e):d(this.el).delegate(h,g,e)}},undelegateEvents:function(){d(this.el).unbind(".delegateEvents"+this.cid)},_configure:function(a){this.options&&(a=c.extend({},this.options,a));for(var b=0,d=p.length;b<d;b++){var e=p[b];a[e]&&(this[e]=a[e])}this.options=a},_ensureElement:function(){if(!this.el){var a=this.attributes||{};this.id&&(a.id=this.id),this.className&&(a["class"]=this.className),this.el=this.make(this.tagName,a)}else c.isString(this.el)&&(this.el=d(this.el).get(0))}});var q=function(a,b){var c=t(this,a,b);return c.extend=this.extend,c};b.Model.extend=b.Collection.extend=b.Router.extend=b.View.extend=q;var r={create:"POST",update:"PUT","delete":"DELETE",read:"GET"};b.sync=function(a,e,f){var g=r[a],h={type:g,dataType:"json",beforeSend:function(a){var b=d('meta[name="csrf-token"]').attr("content");b&&a.setRequestHeader("X-CSRF-Token",b)}};f.url||(h.url=u(e)||v()),!f.data&&e&&(a=="create"||a=="update")&&(h.contentType="application/json",h.data=JSON.stringify(e.toJSON())),b.emulateJSON&&(h.contentType="application/x-www-form-urlencoded",h.data=h.data?{model:h.data}:{}),b.emulateHTTP&&(g==="PUT"||g==="DELETE")&&(b.emulateJSON&&(h.data._method=g),h.type="POST",h.beforeSend=function(a){a.setRequestHeader("X-HTTP-Method-Override",g)}),h.type!=="GET"&&!b.emulateJSON&&(h.processData=!1);if("read"==a){var i="";return h.url?i=h.url:f.url&&(i=f.url),JSONCache.getCachedJSON(i,c.extend(h,f))}return d.ajax(c.extend(h,f))};var s=function(){},t=function(a,b,d){var e;return b&&b.hasOwnProperty("constructor")?e=b.constructor:e=function(){return a.apply(this,arguments)},c.extend(e,a),s.prototype=a.prototype,e.prototype=new s,b&&c.extend(e.prototype,b),d&&c.extend(e,d),e.prototype.constructor=e,e.__super__=a.prototype,e},u=function(a){return!a||!a.url?null:c.isFunction(a.url)?a.url():a.url},v=function(){throw new Error('A "url" property or function must be specified')},w=function(a,b,c){return function(d,e){var e=d===b?e:d;a?a(d,e,c):b.trigger("error",d,e,c)}};return b}),function(){var a=["Msxml2.XMLHTTP","Microsoft.XMLHTTP","Msxml2.XMLHTTP.4.0"],b=/^\s*<\?xml(\s)+version=[\'\"](\d)*.(\d)*[\'\"](\s)*\?>/im,c=/<body[^>]*>\s*([\s\S]+)\s*<\/body>/im,d=typeof location!="undefined"&&location.href,e=d&&location.protocol&&location.protocol.replace(/\:/,""),f=d&&location.hostname,g=d&&(location.port||void 0),h=[];define("text",[],function(){var l,m,s;return typeof window!="undefined"&&window.navigator&&window.document?m=function(a,b){var c=l.createXhr();c.open("GET",a,!0),c.onreadystatechange=function(){c.readyState===4&&b(c.responseText)},c.send(null)}:typeof process!="undefined"&&process.versions&&process.versions.node?(s=require.nodeRequire("fs"),m=function(a,b){b(s.readFileSync(a,"utf8"))}):typeof Packages!="undefined"&&(m=function(a,b){var c=new java.io.File(a),d=java.lang.System.getProperty("line.separator"),c=new java.io.BufferedReader(new java.io.InputStreamReader(new java.io.FileInputStream(c),"utf-8")),e,f,g="";try{e=new java.lang.StringBuffer,(f=c.readLine())&&f.length()&&f.charAt(0)===65279&&(f=f.substring(1));for(e.append(f);(f=c.readLine())!==null;)e.append(d),e.append(f);g=String(e.toString())}finally{c.close()}b(g)}),l={version:"1.0.2",strip:function(a){if(a){var a=a.replace(b,""),d=a.match(c);d&&(a=d[1])}else a="";return a},jsEscape:function(a){return a.replace(/(['\\])/g,"\\$1").replace(/[\f]/g,"\\f").replace(/[\b]/g,"\\b").replace(/[\n]/g,"\\n").replace(/[\t]/g,"\\t").replace(/[\r]/g,"\\r")},createXhr:function(){var b,c,d;if(typeof XMLHttpRequest!="undefined")return new XMLHttpRequest;for(c=0;c<3;c++){d=a[c];try{b=new ActiveXObject(d)}catch(e){}if(b){a=[d];break}}if(!b)throw Error("createXhr(): XMLHttpRequest not available");return b},get:m,parseName:function(a){var b=!1,c=a.indexOf("."),d=a.substring(0,c),a=a.substring(c+1,a.length),c=a.indexOf("!");return c!==-1&&(b=a.substring(c+1,a.length),b=b==="strip",a=a.substring(0,c)),{moduleName:d,ext:a,strip:b}},xdRegExp:/^((\w+)\:)?\/\/([^\/\\]+)/,useXhr:function(a,b,c,d){var e=l.xdRegExp.exec(a),f;return e?(a=e[2],e=e[3],e=e.split(":"),f=e[1],e=e[0],(!a||a===b)&&(!e||e===c)&&(!f&&!e||f===d)):!0},finishLoad:function(a,b,c,d,e){c=b?l.strip(c):c,e.isBuild&&(h[a]=c),d(c)},load:function(a,b,c,h){if(h.isBuild&&!h.inlineText)c();else{var j=l.parseName(a),k=j.moduleName+"."+j.ext,m=b.toUrl(k),n=h&&h.text&&h.text.useXhr||l.useXhr;!d||n(m,e,f,g)?l.get(m,function(b){l.finishLoad(a,j.strip,b,c,h)}):b([k],function(a){l.finishLoad(j.moduleName+"."+j.ext,j.strip,a,c,h)})}},write:function(a,b,c){if(b in h){var d=l.jsEscape(h[b]);c.asModule(a+"!"+b,"define(function () { return '"+d+"';});\n")}},writeFile:function(a,b,c,d,e){var b=l.parseName(b),f=b.moduleName+"."+b.ext,g=c.toUrl(b.moduleName+"."+b.ext)+".js";l.load(f,c,function(){var b=function(a){return d(g,a)};b.asModule=function(a,b){return d.asModule(a,g,b)},l.write(a,f,b,e)},e)}}})}(),define("text!templates/detailResult.html",[],function(){return'<div class="rating">\n    <div class="rateUp arrow up"> </div>\n    <div class="count"><%- rating %></div>\n    <div class="rateDown arrow down"></div>\n</div>\n<div class="word">\n<h2><%- word %> </h2><% if (\'undefined\' !== typeof lang) { print(\'<span>\' + lang+\'</span>\'); } %>\n<p><%- example %></p>\n\n</div>\n\n<span class="edit icon">&#009998; </span>\n<span class="save icon hidden">&#010003;</span>\n'}),define("models/language",["backbone","underscore"],function(a,b){var c=a.Model.extend({});return c}),define("collections/languages",["underscore","backbone","models/language"],function(a,b,c){var d=b.Collection.extend({model:c,url:"languages",initialize:function(a,b){b||(b={}),this.init&&this.init(a,b),this.fetch()}});return new d}),define("views/detailResult",["jquery","backbone","underscore","text!templates/detailResult.html","collections/languages"],function(a,b,c,d,e){var f=b.View.extend({model:null,tagName:"li",className:"detailResult",template:null,initialize:function(){c.bindAll(this,"render","unrender","editWord","saveWord","onClickRating"),this.model=this.options.model,this.model.bind("change",this.render),this.model.view=this,this.template=c.template(d)},onClickRating:function(a){if(!1===AppRouter.checkLoginState())return;var b=this.model.get("user_voted");if(parseInt(b,10)===a){this.model.save({user_voted:0});return}this.model.save({user_voted:a});return},editWord:function(){!0===AppRouter.getLoginState()?(a(".word h2",this.model.el).attr("contentEditable",!0),a(".word h2",this.model.el).focus(),a(".word p",this.model.el).attr("contentEditable",!0),a(".edit.icon",this.model.el).addClass("hidden"),a(".save.icon",this.model.el).removeClass("hidden"),a(".save.icon",this.model.el).on("click",c.bind(this.saveWord,this))):AppRouter.navigate("login",!0)},saveWord:function(){this.model.save({word:a(".word h2",this.model.el).text(),example:a(".word p",this.model.el).text()})},unrender:function(){return a(this.model.el).remove(),this},render:function(){var b=this.model,d=a(this.el),f=b.toJSON();parseInt(a("#targetLanguage").val(),10)===1&&(f.lang=e.get(this.model.get("language_id")).get("code").toUpperCase()),d.html(this.template(f));var g=parseInt(b.get("user_voted"),10);return!0===AppRouter.getLoginState()&&g!==0&&(g===1?a(".rateUp",d).addClass("voted"):g===-1&&a(".rateDown",d).addClass("voted")),a(".rateUp",d).on("click",c.bind(this.onClickRating,this,1)),a(".rateDown",d).on("click",c.bind(this.onClickRating,this,-1)),a(".edit.icon",d).on("click",c.bind(this.editWord,this)),a(".edit.icon",d).removeClass("hidden"),this.model.el=d,this}});return f}),define("text!templates/addWord.html",[],function(){return'    <div id="addWord-box" class="addWord popup">\n        <a href="#" class="closeButton" onclick="return false;">x</a>\n\n        <h1><%- addWordHeading %></h1>\n\n        <form method="post" action="#" onsubmit="return false;">\n            <fieldset>\n\n                <label for="addword_word"><%- word %></label>\n                <input id="addword_word" name="word" value="" type="text" autocomplete="on" placeholder="<%- word %>">\n\n                <label for="addword_example"><%- example %> <%- sentence %></label>\n                <input id="addword_example" name="example" value="" type="text" placeholder="<%- example %> <%- sentence %>">\n\n                <button class="submit button" type="submit"><%- add %></button>\n\n            </fieldset>\n        </form>\n\n        <div class="error hidden"></div>\n    </div>\n'}),define("text!templates/searchResult.html",[],function(){return'<span class="lang"><%= language.code.toUpperCase() %></span>\n<span class="word"><%= word %></span>'}),define("views/searchResult",["jquery","underscore","backbone","text!templates/searchResult.html"],function(a,b,c,d){var e=c.View.extend({tagName:"li",className:"searchResult",initialize:function(){b.bindAll(this,"render","unrender"),this.model.bind("change",this.render),this.model.view=this,this.template=b.template(d)},unrender:function(){return a(this.model.el).remove(),this},render:function(){var b=this.model.toJSON(),c=a(this.el);return c.attr("data-id",b.id),c.html(this.template(b)),this.model.el=c,this}});return e}),define("text!templates/login.html",[],function(){return'<div id="login-box" class="login popup">\n    <a href="#" class="closeButton">x</a>\n    \n    <h1><%= login %></h1>\n    \n    <form method="post" action="#" onsubmit="return false;">\n        <fieldset>\n            \n            <label for="email"><%= email %></label>\n            <input id="email" name="email" value="" type="email" autocomplete="on" placeholder="<%= email %>" />\n            \n            <label for="password"><%= password %></label>\n            <input id="password" name="password" value="" type="password" placeholder="<%= password %>" />\n            \n            <button class="submit button" type="submit"><%= login %></button>\n\n            <p><a class="notMember" href="#signup"><%= notMember %></a></p>\n\n        </fieldset>\n    </form>\n    \n    <div class="error" class="hidden"></div>\n</div>\n'}),define("text!templates/signup.html",[],function(){return'<div id="signup-box" class="signup popup">\n    <a href="#" class="closeButton">x</a>\n    \n    <h1><%= createAccount %></h1>\n    \n    <form action="#" method="post" onsubmit="return false;">\n        <fieldset>\n\n            <label for="user_email"><%= email %></label>\n            <input id="user_email" name="user[email]" size="30" type="email" autocomplete="on" placeholder="<%= email %>" />\n\n            <label for="user_password"><%= password %></label>\n            <input id="user_password" name="user[password]" size="30" type="password" placeholder="<%= password %>" />\n            \n            <label for="user_password_confirmation"><%= passwordConfirmation %></label>\n            <input id="user_password_confirmation" name="user[password_confirmation]" size="30" type="password"\n                   placeholder="<%= confirmPassword %>"/>\n\n            <button class="submit button" type="submit"><%= signup %></button>\n\n        </fieldset>\n    </form>\n    \n    <div class="error"></div>\n</div>\n'}),define("text!templates/flashMessage.html",[],function(){return'<p class="<%= type %>"><%= message %></p>\n'}),define("views/flashMessage",["jquery","underscore","backbone","text!templates/flashMessage.html"],function(a,b,c,d,e){var f={flashHtml:null,showMessage:function(c,e){var f=b.template(d);this.flashHtml=a(f({type:c,message:e})),a("#flashMessage").append(this.flashHtml),this.flashHtml.fadeIn(1e3).delay(4e3).fadeOut(1e3).queue(function(){a(this).remove()})}};return f}),define("models/word",["backbone","underscore"],function(a,b){var c=a.Model.extend({initialize:function(a,b){b||(b={}),this.bind("error",this.defaultErrorHandler),this.init&&this.init(a,b)},defaultErrorHandler:function(a,b){(b.status==401||b.status==403)&&AppRouter.navigate("login",!0)}});return c}),define("collections/abstractWords",["underscore","backbone","models/word"],function(a,b,c){var d=b.Collection.extend({model:c,initialize:function(a,b){b||(b={}),this.bind("error",this.defaultErrorHandler),this.init&&this.init(a,b)},defaultErrorHandler:function(a,b){(b.status==401||b.status==403)&&AppRouter.navigate("login",!0)},getOrFetch:function(b,c){var d=this.get(b);"undefined"==typeof d?this.fetch({url:this.url+"/"+b,success:a.bind(c,this)}):c()},findByWord:function(a){return this.find(function(b){return b.get("word")==a})},addOrUpdate:function(a,b){var c=this.find(function(b){return b.get("word")==a.word});c?c.save(a,b):this.create(a,b)}});return d}),define("collections/words",["backbone","underscore","collections/abstractWords"],function(a,b,c){var d=c.extend({url:"words"});return new d}),define("collections/detailWords",["backbone","underscore","collections/abstractWords"],function(a,b,c){var d=c.extend({});return d}),function(){function a(a,b,c,d,e,f){b[a]&&(c.push(a),(b[a]===!0||b[a]===1)&&d.push(e+a+"/"+f))}function b(a,b,c,d,e){b=d+b+"/"+e,require._fileExists(a.toUrl(b))&&c.push(b)}var c=/(^.*(^|\/)nls(\/|$))([^\/]*)\/?([^\/]*)/,d={};define("i18n",{version:"1.0.0",load:function(e,f,g,h){var h=h||{},i=c.exec(e),j=i[1],k=i[4],l=i[5],m=k.split("-"),p=[],s={},t,u,v="";i[5]?(j=i[1],e=j+l):(l=i[4],k=h.locale||(h.locale=typeof navigator=="undefined"?"root":(navigator.language||navigator.userLanguage||"root").toLowerCase()),m=k.split("-"));if(h.isBuild){p.push(e),b(f,"root",p,j,l);for(t=0;u=m[t];t++)v+=(v?"-":"")+u,b(f,v,p,j,l);f(p,function(){g()})}else f([e],function(b){var c=[];a("root",b,c,p,j,l);for(t=0;u=m[t];t++)v+=(v?"-":"")+u,a(v,b,c,p,j,l);f(p,function(){var a,e;for(a=c.length-1;a>-1&&(u=c[a]);a--){e=b[u];if(e===!0||e===1)e=f(j+u+"/"+l);var h=s,i=void 0;for(i in e)!(i in d)&&!(i in h)&&(h[i]=e[i])}g(s)})})}})}(),define("nls/trailsy",{root:{login:"Log in",login_success:"You have been successfully logged in!",login_error:"You supplied a wrong Username or Password.",logout_success:"You have been successfully logged out!",logout_error:"There was an error at logging you out. Please verify that you are correctly logged out.",signup_aftersubmit:"Before logging in you have to confirm your Email address. Watch your inbox for next instructions.",validation_success:"Your Email address was successfully verified.",validation_error:"This validation is invalid.",word:"Word",addTranslationFor:"Add a Translation for",addWord:"Add a Word",example:"Example",sentence:"Sentence",lang:"Language",email:"Email",email_notUnique:"Your Email Address is already registered.",email_malformed:"Your supplied Email Address is not valid. Please supply a valid Email address, as you need to verify it later.",password:"Password",signup:"Sign up",add:"Add",forgotPassword:"Forgot your Password?",notMember:"Not a Member? Create Account now!",confirmPassword:"Confirm your Password",password_notMatch:"Your confirmation doesnt match the supplied Password.",password_tooShort:"Your Password is too short (min 6 characters).",passwordConfirmation:"Password confirmation",createAccount:"Create a new Account"},"de-de":!0}),define("views/addWordDialog",["jquery","underscore","text!templates/addWord.html","i18n!nls/trailsy"],function(a,b,c,d){var e={collection:null,addWordHtml:null,setCollection:function(a){this.collection=a},applyTemplate:function(){var e=a("input#word").val(),f={addWordHeading:d.addTranslationFor+" "+e,word:d.word,example:d.example,add:d.add,sentence:d.sentence};"addWord"===this.dialogType&&(f.addWordHeading=d.addWord);var g=b.template(c);this.addWordHtml=a(g(f));var h=parseInt(a("#targetLanguage").val(),10),i=a("#sourceLanguage"),j=parseInt(i.val(),10);if("addWord"===this.dialogType&&1===j||"addTranslation"===this.dialogType&&1===h){var k=a('<label for="sourceLanguage">'+d.lang+"</label>");a("#addword_example",this.addWordHtml).after(k);var l=i.clone();a('[value="1"]',l).remove(),l.attr("id","addword_language"),k.after(l),l.val(h),"addWord"===this.dialogType?(l.val(i.val()),a("#addword_word",this.addWordHtml).val(e)):1!==j&&a('[value="'+j+'"]',l).remove()}},appendDiv:function(){a("nav").append(this.addWordHtml)},setDialogType:function(a){this.dialogType=a},show:function(){this.applyTemplate(),this.appendDiv(),this.addWordHtml.fadeIn(300);var c=(this.addWordHtml.height()+24)/2,d=(this.addWordHtml.width()+24)/2;this.addWordHtml.css({"margin-top":-c,"margin-left":-d}),"addWord"===this.dialogType?a("#addword_example",this.addWordHtml).focus():a("#addword_word",this.addWordHtml).focus(),a("#addWord-box .closeButton").on("click",b.bind(this.hide,this)),a("#addWord-box form").on("submit",b.bind(this.submitForm,this))},saveSuccess:function(a){"addWord"===this.dialogType&&AppRouter.navigate("words/"+a.id,!0),this.hide()},saveFailed:function(b){(b.status==401||b.status==403)&&AppRouter.navigate("login",!0),a("#addWord-box .error").removeClass("hidden"),a("#addWord-box .error").text("An Error occured.")},hide:function(){a("input",this.addWordHtml).val(""),a("#addWord-box").fadeOut(300,b.bind(function(){this.addWordHtml.remove()},this)),a("#addWord-box .closeButton").unbind(),a("#addWord-box form").unbind()},getLanguageId:function(){var b=a("#addword_language",this.addWordHtml).val();return undefined!=b?b:a("#targetLanguage").val()},submitForm:function(){var c={word:a("#addword_word",this.addWordHtml).val(),example:a("#addword_example",this.addWordHtml).val(),language_id:this.getLanguageId()},d={success:b.bind(this.saveSuccess,this),error:b.bind(this.saveFailed,this)};"addWord"===this.dialogType&&(d.silent=!0),this.collection.addOrUpdate(c,d)}};return e}),define("views/detailResultList",["jquery","underscore","backbone","views/detailResult","views/addWordDialog","i18n!nls/trailsy"],function(a,b,c,d,e,f){var g=c.View.extend({el:a("#translations"),input:a("input#word"),collection:null,events:{"click #addWord":"onClickAdd"},initialize:function(){this.items_element=a("#translationList"),b.bindAll(this,"render","onClickAdd","appendItem","unrender","setCollection","appendAddWordLink")},onClickAdd:function(a){a.preventDefault(),a.stopPropagation(),e.setCollection(this.collection),e.setDialogType("addTranslation"),e.show()},appendAddWordLink:function(){var a=this.input.val();this.items_element.append('<li class="detailResult"><a href="#" id="addWord">'+f.addTranslationFor+" "+a+"</a></li>")},setCollection:function(a){this.collection=a,this.collection.bind("add",this.render)},unrender:function(){this.items_element.html(""),this.items_element.addClass("hidden")},appendItem:function(a){var b=this.collection.get(a.id),c=new d({model:b}),e=c.render(this.search).el;this.items_element.append(e)},render:function(a){"string"==typeof a&&(this.targetLang=parseInt(a,10)),this.unrender(),this.items_element.removeClass("hidden"),this.collection.each(function(a){(parseInt(a.get("language_id"),10)===this.targetLang||this.targetLang===1)&&this.appendItem(a)},this),this.appendAddWordLink()}});return new g}),define("views/searchResultList",["jquery","underscore","backbone","views/searchResult","views/detailResultList","views/addWordDialog","i18n!nls/trailsy","collections/words"],function(a,b,c,d,e,f,g,h){var i=c.View.extend({el:a("#search"),input:a("input#word"),collection:null,searchTimeout:null,events:{"keydown input#word":"keyDown","keyup input#word":"keyUp","search input#word":"search","blur input#word":"blur","focus input#word":"focus","change #sourceLanguage, #targetLanguage":"changeLang","mousedown #addWord":"onClickAdd"},initialize:function(){this.items_element=a("ul#result"),b.bindAll(this,"unrender","render","search","changeLang","appendItem","focus","blur","keyDown","keyUp","delayedSearch","onClickAdd"),this.collection=h,this.collection.bind("refresh",this.render),this.collection.bind("add",this.render)},onClickAdd:function(a){a.preventDefault(),a.stopPropagation(),f.setCollection(this.collection),f.setDialogType("addWord"),f.show(!0)},changeLang:function(){this.search()},focus:function(){},blur:function(){!1===a.browser.mobile&&this.items_element.addClass("hidden");var b=this.items_element.children("li.selected");b.length&&b.removeClass("selected")},keyUp:function(a){if(a.keyCode==27||a.keyCode==13||a.keyCode==9||a.keyCode==40||a.keyCode==38)return!0;this.delayedSearch()},delayedSearch:function(){this.searchTimeout&&clearTimeout(this.searchTimeout),this.searchTimeout=setTimeout(b.bind(function(){this.search()},this),350)},search:function(){this.searchTimeout&&clearTimeout(this.searchTimeout);var b=this.input.val();if(b.length<3)return this.blur(),AppRouter.navigate("home",!0),!0;AppRouter.navigate("search/"+b+"/from/"+a("#sourceLanguage").val()+"/to/"+a("#targetLanguage").val(),!0)},keyDown:function(b){if(b.keyCode==27)return b.preventDefault(),this.blur(),AppRouter.navigate("home",!0),!1;if(b.keyCode==13||b.keyCode==9){var c=this.items_element.children("li.selected");if(c.length){var d=c.attr("data-id");return AppRouter.navigate(this.collection.url+"/"+parseInt(d,10)+"/targetLang/"+a("#targetLanguage").val(),!0),this.input.blur(),!1}return this.search(),!0}if(b.keyCode==40){b.preventDefault();var c=this.items_element.children("li.selected");return c.length==0?this.items_element.children("li:first").addClass("selected"):c==this.items_element.children("li:last")?c.removeClass("selected"):c.removeClass("selected").next("li").addClass("selected"),!1}if(b.keyCode==38){b.preventDefault();var c=this.items_element.children("li.selected");return c.length==0?this.items_element.children("li:last").addClass("selected"):c==this.items_element.children("li:first")?c.removeClass("selected"):c.removeClass("selected").prev("li").addClass("selected"),!1}return!0},appendAddWordLink:function(){var a=this.input.val();this.el.append('<a href="#" id="addWord">'+g.add+" "+g.word+" "+a+"</a>")},unrender:function(){this.items_element.html(""),a("#addWord",this.el).remove(),e.unrender()},appendItem:function(b){var c=new d({model:b});el=c.render().el;var e=this;a(el).on("mousedown",function(){AppRouter.navigate(e.collection.url+"/"+b.get("id")+"/targetLang/"+a("#targetLanguage").val(),!0)}),this.items_element.append(el)},render:function(){this.unrender(),this.input.focus();if(0===this.collection.length){this.appendAddWordLink();return}this.collection.each(function(a){this.appendItem(a)},this),this.items_element.removeClass("hidden")}});return new i}),define("views/loginDialog",["jquery","underscore","text!templates/login.html","views/flashMessage","i18n!nls/trailsy"],function(a,b,c,d,e){var f={loginHtml:null,mask:a("#mask"),errorDiv:null,form:null,show:function(){if(null===this.loginHtml){var d=b.template(c);this.loginHtml=a(d(e)),a("nav").append(this.loginHtml),this.errorDiv=a("#login-box .error"),this.form=a("#login-box form")}this.loginHtml.css({"margin-top":(this.loginHtml.height()+24)/-2,"margin-left":(this.loginHtml.width()+24)/-2}),this.mask.fadeIn(300),this.loginHtml.fadeIn(300),a("#login-box a, #mask").on("click",b.bind(this.hide,this)),this.form.on("submit",b.bind(this.submitForm,this)),a("#login-box #email").focus()},hide:function(){a("#mask , #login-box").fadeOut(300,b.bind(function(){this.clearErrors(),a("#login-box form input").val(""),a("#login-box a, #mask").unbind(),this.form.unbind()},this)),AppRouter.navigate("home",!0)},clearErrors:function(){this.errorDiv.hide(),this.errorDiv.empty()},submitForm:function(){this.form.length&&a.ajax({url:"/sessions",data:this.form.serialize(),type:"POST",beforeSend:b.bind(function(b){var c=a('meta[name="csrf-token"]').attr("content");c&&b.setRequestHeader("X-CSRF-Token",c),this.clearErrors()},this),success:b.bind(this.loginSuccess,this),error:b.bind(this.loginError,this)})},loginSuccess:function(){d.showMessage("info",e.login_success),a("#loginLink").addClass("hidden"),a("#logoutLink").removeClass("hidden"),a("#signupLink").addClass("hidden"),AppRouter.setLoginState(!0),this.hide()},loginError:function(){this.errorDiv.text(e.login_error),this.errorDiv.show()},logout:function(){a.ajax({url:"/log_out",type:"GET",contentType:"application/json; charset=utf-8",beforeSend:function(b){var c=a('meta[name="csrf-token"]').attr("content");c&&b.setRequestHeader("X-CSRF-Token",c)},success:b.bind(function(){a("#logoutLink").addClass("hidden"),a("#loginLink").removeClass("hidden"),a("#signupLink").removeClass("hidden"),AppRouter.setLoginState(!1),d.showMessage("info",e.logout_success)},this),error:b.bind(function(){d.showMessage("error",e.logout_error)},this)})}};return f}),define("views/signupDialog",["jquery","underscore","text!templates/signup.html","views/flashMessage","i18n!nls/trailsy"],function(a,b,c,d,e){var f={signupHtml:null,mask:a("#mask"),errorDiv:null,form:null,show:function(){if(null===this.signupHtml){var d=b.template(c);this.signupHtml=a(d(e)),a("nav").append(this.signupHtml),this.errorDiv=a("#signup-box .error"),this.form=a("#signup-box form")}this.signupHtml.css({"margin-top":(this.signupHtml.height()+24)/-2,"margin-left":(this.signupHtml.width()+24)/-2}),this.signupHtml.fadeIn(300),this.mask.fadeIn(300),a("#signup-box a, #mask").on("click",b.bind(this.hide,this)),this.form.on("submit",b.bind(this.submitForm,this)),a("#signup-box #user_email").focus()},hide:function(){a("#mask , #signup-box").fadeOut(300,b.bind(function(){a("#signup-box a, #mask").unbind(),this.form.unbind(),a("#signup-box form input").val(""),this.clearErrors()},this)),AppRouter.navigate("home",!0)},clearErrors:function(){this.errorDiv.hide(),this.errorDiv.empty()},submitForm:function(){this.form.length&&a.ajax({url:"/users",data:this.form.serialize(),type:"POST",beforeSend:b.bind(function(b){var c=a('meta[name="csrf-token"]').attr("content");c&&b.setRequestHeader("X-CSRF-Token",c),this.clearErrors()},this),success:b.bind(this.signupSuccess,this),error:b.bind(this.signupError,this)})},signupSuccess:function(){d.showMessage("info",e.signup_aftersubmit),this.hide()},signupError:function(c,d,f){var g=a.parseJSON(c.responseText),h=a("<ul></ul>");b.each(g,function(c,d){var f=a("<li>");f.text(d),h.append(f),b.each(c,function(b){var c=a("<p>").text(e[b]);f.append(c)})}),this.errorDiv.append(h),this.errorDiv.show()},validation:function(c,d){a.ajax({url:"/user/"+c+"/validate/"+d,type:"GET",contentType:"application/json; charset=utf-8",beforeSend:function(b){var c=a('meta[name="csrf-token"]').attr("content");c&&b.setRequestHeader("X-CSRF-Token",c)},success:b.bind(this.validationSuccess,this),error:b.bind(this.validationError,this)})},validationSuccess:function(){d.showMessage("success",e.validation_success)},validationError:function(){d.showMessage("error",e.validation_error)}};return f}),define("router",["jquery","underscore","backbone","views/detailResultList","views/searchResultList","views/loginDialog","views/signupDialog","views/flashMessage","collections/words","collections/detailWords","i18n!nls/trailsy"],function(a,b,c,d,e,f,g,h,i,j,k){var l=c.Router.extend({loginState:!1,input:a("input#word"),routes:{"":"home",login:"login",logout:"logout",signup:"signup","search/:query/from/:fromLang/to/:toLang":"search","words/:word/targetLang/:lang":"words","validation/:id/code/:code":"validation"},initialize:function(){this.setLoginState(a("#loginLink").hasClass("hidden"))},home:function(){},setLoginState:function(a){this.loginState=a},getLoginState:function(){return this.loginState},checkLoginState:function(){return!1===this.getLoginState()?(this.navigate("login",!0),!1):!0},words:function(c,e){i.getOrFetch(c,b.bind(function(){var f=i.get(c);this.setSearchText(f.get("word")),this.setFromLangValue(f.get("language_id"));var g=new j(f.get("translations"));g.url="words/"+c+"/translations";if(!0===a.browser.mobile){a("#search, #user").css("-webkit-transform","translate(-450px, 0px)");var h=this;setTimeout(function(){var c=a("nav").append('<a href="#"  class="back">&#x2B05;</a>');a(".back",c).on("click",b.bind(h.onClickBack,h)),a("#search, #user").addClass("hidden"),d.setCollection(g),d.render(e)},500)}else d.setCollection(g),d.render(e)},this)),this.setTargetLangValue(e)},onClickBack:function(b){b.preventDefault(),b.stopPropagation(),a(".back").remove(),a("#search, #user").removeClass("hidden"),a("#search, #user").css("-webkit-transform","translate(0px, 0px)"),window.history.back()},setFromLangValue:function(b){a("#sourceLanguage").val(b)},setTargetLangValue:function(b){var c=a("#targetLanguage");c.val(b)},setSearchText:function(a){this.input.val(a)},search:function(b,c,d){this.input.addClass("loading"),i.fetch({data:jQuery.param({word:b,fromLang:c,toLang:d}),url:"words/search",success:function(){e.render(),a("input#word").removeClass("loading")},error:function(){a("input#word").removeClass("loading")}}),this.setSearchText(b),this.setFromLangValue(c),this.setTargetLangValue(d)},login:function(){f.show()},logout:function(){f.logout()},signup:function(){g.show()},validation:function(a,b){g.validation(a,b)}}),m=function(){window.AppRouter=new l,c.history.start({pushStack:!0})};return{init:m}}),define("app",["jquery","backbone","router"],function(a,b,c){var d=function(){c.init(),a("input#word").focus()};return{init:d}}),define("domReady",[],function(){function a(a){for(var b=0,c;c=a[b];b++)c(g)}function b(){var b=h,c=i;f&&(b.length&&(h=[],a(b)),j.resourcesDone&&c.length&&(i=[],a(c)))}function c(){f||(f=!0,l&&clearInterval(l),b())}function d(a){return f?a(g):h.push(a),d}var e=typeof window!="undefined"&&window.document,f=!e,g=e?document:null,h=[],i=[],j=requirejs||require||{},k=j.resourcesReady,l;return"resourcesReady"in j&&(j.resourcesReady=function(a){k&&k(a),a&&b()}),e&&(document.addEventListener?(document.addEventListener("DOMContentLoaded",c,!1),window.addEventListener("load",c,!1)):window.attachEvent&&(window.attachEvent("onload",c),self===self.top&&(l=setInterval(function(){try{document.body&&(document.documentElement.doScroll("left"),c())}catch(a){}},30))),document.readyState==="complete"&&c()),d.withResources=function(a){return f&&j.resourcesDone?a(g):i.push(a),d},d.version="1.0.0",d.load=function(a,b,c,e){e.isBuild?c(null):d(c)},d}),function(a){jQuery.browser.mobile=/android.+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino/i.test(a)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|e\-|e\/|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(di|rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|xda(\-|2|g)|yas\-|your|zeto|zte\-/i.test(a.substr(0,4))}(navigator.userAgent||navigator.vendor||window.opera),define("vendor/detectmobilebrowser",function(){}),function(a){var b="JSONCache size",c="JSONCache data ",d="JSONCache time ",e={version:"#VERSION#",debug:!0,numTries:5,waitTime:200,itemLifetime:3e5,maxCacheSize:2621440,autoEvict:!0},f={};f.settings=e;var g=function(){if(e.debug&&window.console){var a=Array.prototype.slice.call(arguments);a.unshift("JSONCache:"),console.log.apply(console,a)}};e.browserOk=function(){var a=window.JSON&&typeof window.JSON.parse=="function"&&typeof window.JSON.stringify=="function",b;try{b="localStorage"in window&&window.localStorage!==null}catch(c){b=!1}return a&&b}();var h=function(a){var c=parseInt(window.localStorage[b],10);c=isNaN(c)?0:c;var d=c+a*2;d>0?window.localStorage[b]=d:window.localStorage.removeItem(b)},i=function(a,b){var g=JSON.stringify(b),i=g.length,j=f._getTime(),k=function(){return f.getCacheSize()+i*2},l=function(){if(k()>e.maxCacheSize){f.clean();if(k()>e.maxCacheSize)throw new Error("Cache add would exceed maxCacheSize ("+k()+" > "+e.maxCacheSize+")")}try{window.localStorage[c+a]=g,window.localStorage[d+a]=j,h(i)}catch(b){throw new Error("Error adding data to localStorage, quota might be full.")}};if(!e.autoEvict){l();return}for(;;)try{l();return}catch(m){if(f.getCacheSize()===0)throw new Error("Cache add would exceed maxCacheSize ("+k()+" > "+e.maxCacheSize+") even after autoEvicting everything");f.purgeOldest()}};f.getCacheSize=function(){var a=parseInt(window.localStorage[b],10);return isNaN(a)?0:a};var j=function(a){var b=parseInt(a,10);return!isNaN(b)&&b+e.itemLifetime>=f._getTime()};f.clear=function(a){if(a){if(window.localStorage[c+a]){var e=window.localStorage[c+a].length;h(-1*e)}window.localStorage.removeItem(c+a),window.localStorage.removeItem(d+a)}else{var f=/^JSONCache (data|time) /,g,i,j=window.localStorage.length,k=[];for(g=0;g<j;++g)i=window.localStorage.key(g),f.test(i)&&k.push(i);j=k.length;for(g=0;g<j;++g)window.localStorage.removeItem(k[g]);window.localStorage.removeItem(b)}},f.clean=function(){var a=/^JSONCache time ([\S]+)$/,b,c,d=[],e,g=window.localStorage.length;for(e=0;e<g;++e)b=window.localStorage.key(e),c=a.exec(b),c&&!j(window.localStorage[b])&&d.push(c[1]);g=d.length;for(e=0;e<g;++e)f.clear(d[e])},f.purgeOldest=function(){var a=/^JSONCache time /,b,c=null,e,g,h=window.localStorage.length;for(var i=0;i<h;++i){e=window.localStorage.key(i);if(!a.test(e))continue;g=parseInt(window.localStorage[e],10),!isNaN(g)&&(c===null||g<c)&&(b=e,c=g)}c!==null&&f.clear(b.replace(d,""))},f._getJSONProxy=function(b,c){a.ajax(b,c)},f._getTime=function(){return(new Date).getTime()},f._tryGetJSON=function(a,b,c,d){if(c>e.numTries){g("Tried fetching",c-1,"times already, returning."),typeof b.ongiveup=="function"&&b.ongiveup("timeout");return}b.error=function(e,h,i){g("Ajax error with status:",h),typeof b.onerror=="function"&&b.onerror(e,h,i,c),window.setTimeout(function(){f._tryGetJSON(a,b,c+1,d*2)},d)},typeof b.ontry=="function"&&b.ontry(c),f._getJSONProxy(a,b)},f.getCachedJSON=function(a,b){b=b||{};var h=b.success,k=window.localStorage[c+a],l=window.localStorage[d+a];k&&j(l)?(g("Value found from cache for url:",a),typeof h=="function"&&h(JSON.parse(k))):(g("Value not found in cache fetching data from url:",a),b.success=function(c){g("Fetched data, adding to cache for url:",a);try{i(a,c)}catch(d){if(typeof b.ongiveup=="function"){b.ongiveup("addfailure");return}}typeof h=="function"&&h(c)},b.dataType="json",f._tryGetJSON(a,b,1,e.waitTime))},window.JSONCache=f}(jQuery),define("jsoncache",function(){});var JSON;JSON||(JSON={}),function(){function f(a){return a<10?"0"+a:a}function quote(a){return escapable.lastIndex=0,escapable.test(a)?'"'+a.replace(escapable,function(a){var b=meta[a];return typeof b=="string"?b:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+a+'"'}function str(a,b){var c,d,e,f,g=gap,h,i=b[a];i&&typeof i=="object"&&typeof i.toJSON=="function"&&(i=i.toJSON(a)),typeof rep=="function"&&(i=rep.call(b,a,i));switch(typeof i){case"string":return quote(i);case"number":return isFinite(i)?String(i):"null";case"boolean":case"null":return String(i);case"object":if(!i)return"null";gap+=indent,h=[];if(Object.prototype.toString.apply(i)==="[object Array]"){f=i.length;for(c=0;c<f;c+=1)h[c]=str(c,i)||"null";return e=h.length===0?"[]":gap?"[\n"+gap+h.join(",\n"+gap)+"\n"+g+"]":"["+h.join(",")+"]",gap=g,e}if(rep&&typeof rep=="object"){f=rep.length;for(c=0;c<f;c+=1)typeof rep[c]=="string"&&(d=rep[c],e=str(d,i),e&&h.push(quote(d)+(gap?": ":":")+e))}else for(d in i)Object.prototype.hasOwnProperty.call(i,d)&&(e=str(d,i),e&&h.push(quote(d)+(gap?": ":":")+e));return e=h.length===0?"{}":gap?"{\n"+gap+h.join(",\n"+gap)+"\n"+g+"}":"{"+h.join(",")+"}",gap=g,e}}typeof Date.prototype.toJSON!="function"&&(Date.prototype.toJSON=function(a){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":null},String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(a){return this.valueOf()});var cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},rep;typeof JSON.stringify!="function"&&(JSON.stringify=function(a,b,c){var d;gap="",indent="";if(typeof c=="number")for(d=0;d<c;d+=1)indent+=" ";else typeof c=="string"&&(indent=c);rep=b;if(!b||typeof b=="function"||typeof b=="object"&&typeof b.length=="number")return str("",{"":a});throw new Error("JSON.stringify")}),typeof JSON.parse!="function"&&(JSON.parse=function(text,reviver){function walk(a,b){var c,d,e=a[b];if(e&&typeof e=="object")for(c in e)Object.prototype.hasOwnProperty.call(e,c)&&(d=walk(e,c),d!==undefined?e[c]=d:delete e[c]);return reviver.call(a,b,e)}var j;text=String(text),cx.lastIndex=0,cx.test(text)&&(text=text.replace(cx,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)}));if(/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return j=eval("("+text+")"),typeof reviver=="function"?walk({"":j},""):j;throw new SyntaxError("JSON.parse")})}(),define("json2",function(){}),require.config({paths:{underscore:"vendor/underscore",backbone:"vendor/backbone",json2:"vendor/json2",jsoncache:"vendor/jsoncache"}}),require(["jquery","underscore","backbone","app","domReady","vendor/detectmobilebrowser","jsoncache","json2"],function(a,b,c,d,e,f,g,h){e(function(){d.init()})}),define("main",function(){})