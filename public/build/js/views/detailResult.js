define(["jquery","backbone","underscore","text!templates/detailResult.html","collections/languages"],function(a,b,c,d,e){var f=b.View.extend({model:null,tagName:"li",className:"detailResult",template:null,initialize:function(){c.bindAll(this,"render","unrender","editWord","saveWord","onClickRating"),this.model=this.options.model,this.model.bind("change",this.render),this.model.view=this,this.template=c.template(d)},onClickRating:function(a){if(!1===AppRouter.checkLoginState())return;var b=this.model.get("user_voted");if(parseInt(b,10)===a){this.model.save({user_voted:0});return}this.model.save({user_voted:a});return},editWord:function(){!0===AppRouter.getLoginState()?(a(".word h2",this.model.el).attr("contentEditable",!0),a(".word h2",this.model.el).focus(),a(".word p",this.model.el).attr("contentEditable",!0),a(".edit.icon",this.model.el).addClass("hidden"),a(".save.icon",this.model.el).removeClass("hidden"),a(".save.icon",this.model.el).on("click",c.bind(this.saveWord,this))):AppRouter.navigate("login",!0)},saveWord:function(){this.model.save({word:a(".word h2",this.model.el).text(),example:a(".word p",this.model.el).text()})},unrender:function(){return a(this.model.el).remove(),this},render:function(){var b=this.model,d=a(this.el),f=b.toJSON();parseInt(a("#targetLanguage").val(),10)===1&&(f.lang=e.get(this.model.get("language_id")).get("code").toUpperCase()),d.html(this.template(f));var g=parseInt(b.get("user_voted"),10);return!0===AppRouter.getLoginState()&&g!==0&&(g===1?a(".rateUp",d).addClass("voted"):g===-1&&a(".rateDown",d).addClass("voted")),a(".rateUp",d).on("click",c.bind(this.onClickRating,this,1)),a(".rateDown",d).on("click",c.bind(this.onClickRating,this,-1)),a(".edit.icon",d).on("click",c.bind(this.editWord,this)),a(".edit.icon",d).removeClass("hidden"),this.model.el=d,this}});return f})