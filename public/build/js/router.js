define(["jquery","underscore","backbone","views/detailResultList","views/searchResultList","views/loginDialog","views/signupDialog","views/flashMessage","collections/words","collections/detailWords","i18n!nls/trailsy"],function(a,b,c,d,e,f,g,h,i,j,k){var l=c.Router.extend({loginState:!1,input:a("input#word"),routes:{"":"home",login:"login",logout:"logout",signup:"signup","search/:query/from/:fromLang/to/:toLang":"search","words/:word/targetLang/:lang":"words","validation/:id/code/:code":"validation"},initialize:function(){this.setLoginState(a("#loginLink").hasClass("hidden"))},home:function(){},setLoginState:function(a){this.loginState=a},getLoginState:function(){return this.loginState},checkLoginState:function(){return!1===this.getLoginState()?(this.navigate("login",!0),!1):!0},words:function(c,e){i.getOrFetch(c,b.bind(function(){var f=i.get(c);this.setSearchText(f.get("word")),this.setFromLangValue(f.get("language_id"));var g=new j(f.get("translations"));g.url="words/"+c+"/translations";if(!0===a.browser.mobile){a("#translations").css("-webkit-transform","translate(0px, 0px)"),a("#search, #user").css("-webkit-transform","translate(-450px, 0px)");var h=this;setTimeout(function(){var c=a("nav").append('<a href="#"  class="back">&#x2B05;</a>');a(".back",c).on("click",b.bind(h.onClickBack,h)),a("#search, #user").addClass("hidden"),d.setCollection(g),d.render(e)},500)}else d.setCollection(g),d.render(e)},this)),this.setTargetLangValue(e)},onClickBack:function(b){b.preventDefault(),b.stopPropagation(),a("#translations, .back").css("-webkit-transform","translate(450px, 0px)"),setTimeout(function(){a(".back").remove(),a("#search, #user").removeClass("hidden"),a("#search, #user").css("-webkit-transform","translate(0px, 0px)"),window.history.back()},500)},setFromLangValue:function(b){a("#sourceLanguage").val(b)},setTargetLangValue:function(b){var c=a("#targetLanguage");c.val(b)},setSearchText:function(a){this.input.val(a)},search:function(b,c,d){this.input.addClass("loading"),i.fetch({data:jQuery.param({word:b,fromLang:c}),url:"words/search",success:function(){e.render(),a("input#word").removeClass("loading")},error:function(){a("input#word").removeClass("loading")}}),this.setSearchText(b),this.setFromLangValue(c),this.setTargetLangValue(d)},login:function(){f.show()},logout:function(){f.logout()},signup:function(){g.show()},validation:function(a,b){g.validation(a,b)}}),m=function(){window.AppRouter=new l,c.history.start({pushStack:!0})};return{init:m}})